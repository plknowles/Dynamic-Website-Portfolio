<!DOCTYPE html>
<html lang = "en">
  <head>
    <meta charset = "utf-8">
    <link rel = "icon" href = "{{ url_for('static', filename = 'images/favicon.png') }}" type = "image/x-icon">
    <link rel = "stylesheet" href = "{{ url_for('static', filename='styles.css') }}">
    <meta name = "viewport" content = "width=device-width, initial-scale=1">
    <title>{{ title }} - CMT120 Peter Knowles- </title>
    {% block head %}
    {% endblock %}
  </head>
  <body>
    <nav id = "nav-flexbox">
      <div id = "logo">
        <a href='/'>
          <img  src = "{{ url_for('static', filename = 'images/logo.png') }}" title = "PK Logo" alt = "PK Logo">
        </a>
      </div>
      <div id = "navlink-container">
      {% if user.is_authenticated %}
      <a class = "navlink" href = '/'>Home</a>
      <a class = "navlink" href = '/about'>About Me</a>
      <a class = "navlink" href = "/experience">My experience</a>
      <a class = "navlink" href = "/projects">My projects</a>
      <a class = "navlink" href = "/search">Site Search</a>
      <a class = "navlink" href = "/logout">Logout</a>
      {% else %}
      <a class = "navlink" href = "/login">Login</a>
      <a class = "navlink" href = "/signup">Create Account</a>
      {% endif %}
      </div>
    </nav>
    <div class = "content">
      <!-- flash messages -->
      {% with messages = get_flashed_messages(with_categories = true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class = "alert-{{ category }}" role = "alert">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}      
      
      <div id = "header">
        <h1>{{ header }}</h1>
      </div>
      
      <main>
        {% block main %}
        {% endblock %}

        {% if user.is_authenticated %}
          {% block commentsblock %}
            <form class = "comment-form" method = "POST">
              <h2>Comments</h2>
            
              <ul class = "comments-list">
                  {% for comment in comments %}
                  <div class="{{ 'even' if loop.index is even else 'odd' }}">
                      <strong>{{ comment.name }}</strong> - {{ comment.date.strftime('%d %B %Y') }} &nbsp; {{ comment.date.strftime('%H:%M') }}
                      <br>
                      {{ comment.text }}
                  </div>
                  {% endfor %}
              </ul>
            
              <h3>Leave a new comment</h3>
            
              <textarea rows = "4" class = "comment-textarea" name = "comment" placeholder = "Enter new comment here"></textarea>
              <div>
                <button type = "submit" class = "comment-form-button">Add Comment</button>
              </div>
            </form>
          {% endblock %}
        {% endif %}
      </main>
    </div>
    <footer>
      <span id="footer-text">
      Made with<span class = "heart">&#160;&#10084;&#160;</span>by Peter Knowles - December 2023 - Contact:&#160;<a href = "mailto:knowlesp2@cardiff.ac.uk">knowlesp2@cardiff.ac.uk</a>
      </span>
      <a id = "top-button" href = "#top"><strong>Return to top</strong></a>
    </footer>
    <script src = "{{ url_for('static', filename = 'underlineActiveLinks.js') }}"></script>
  </body>
</html>